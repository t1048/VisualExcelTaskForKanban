# VisualExcelTaskForKanban

Excel のタスク一覧を読み込み、ドラッグ&ドロップ可能なカンバンボードとして可視化するデスクトップアプリケーションです。PyWebView を介してローカル HTML を表示し、Excel ファイルの編集・保存までを Python バックエンドで担います。

## 主な機能

### カンバンボード
- Excel (`task.xlsx`) の各行をカードとして表示し、ステータス列ごとに整理。
- ステータス列上でのドラッグ&ドロップによる進捗更新と即時反映。
- タスク追加・編集・削除モーダル。
- 担当者／キーワード／ステータス／期限（前後・期間）でのフィルタリング機能。
- 期限切れ・期限間近タスクのハイライトと件数サマリー。
- 優先度列の昇順ソート（数値・文字列どちらも対応）。
- Excel のデータ検証（プルダウン）設定を読み取り、ステータス候補を自動で同期。
- 入力規則（候補値）の編集 UI。保存時は Excel 側のデータ検証も更新。

### タイムラインビュー (`timeline.html`)
- 担当者単位でタスクを縦軸に、日付を横軸に並べた簡易ガントチャート風表示。
- 表示期間の指定（任意の日付範囲、今週・来週などのクイック選択）。
- ステータス／担当者／キーワードによるフィルタリングと集計。
- カンバンビューへ戻るショートカットボタン。

### Excel 連携
- 必須列は `No / ステータス / タスク / 担当者 / 優先度 / 期限 / 備考`。
- Excel に該当列が不足している場合は自動で追加。
- 優先度列が未追加の場合のマイグレーション手順:
  1. カンバンで利用している Excel ファイル（既定では `task.xlsx`）を Excel 等で開く。
  2. `担当者` 列の右隣に新しい列を挿入し、列名を **優先度** に変更。
  3. 既存タスクの優先度を必要に応じて入力（数値・文字列どちらでも可）。
  4. ファイルを保存。

## 動作環境

| 項目 | 内容 |
| ---- | ---- |
| OS | Windows / macOS / Linux （PyWebView が動作する環境） |
| Python | 3.10 以上を推奨（`str \| None` などのシンタックスを使用） |
| Excel | `task.xlsx` を含む任意の .xlsx ファイル |

### 必要な Python パッケージ

```
pip install pandas openpyxl pywebview
```

※ Windows で WebView2 ランタイムが未導入の場合は [Microsoft Edge WebView2](https://developer.microsoft.com/microsoft-edge/webview2/#download-section) のインストールが必要になることがあります。

## 実行方法

1. 上記パッケージをインストールした Python 仮想環境を用意します。
2. `task.xlsx`（または自分の Excel ファイル）をプロジェクト直下に置きます。
3. 次のコマンドでバックエンドを起動します。

```bash
python backend.py --excel ./task.xlsx --html ./index.html
```

PyWebView ウィンドウが開き、カンバンボードが表示されます。ツールバーの「保存」で Excel へ書き戻し、「再読込」で Excel から最新状態を再読み込みします。

### コマンドライン引数

`backend.py` では以下のオプションが利用できます。

| 引数 | 既定値 | 説明 |
| ---- | ------ | ---- |
| `--excel` | `./task.xlsx` | 読み込む Excel ファイルのパス |
| `--sheet` | なし | 読み込むシート名（未指定時は先頭シート） |
| `--html` | `./index.html` | 表示するフロントエンド HTML のパス |
| `--title` | `タスク・ボード` | ウィンドウタイトル |
| `--width` | `1280` | ウィンドウ幅（ピクセル） |
| `--height` | `800` | ウィンドウ高さ（ピクセル） |
| `--debug` | `False` | PyWebView のデバッグモードを有効化（開発時向け） |

### Windows 用バッチ

Windows で Miniconda を利用している場合は、同梱の `VisualExcelTaskForKanban.bat` を編集して利用することで、仮想環境の有効化とアプリ起動をまとめて行えます。

## ライセンス

このリポジトリは [MIT License](./LICENSE) の下で公開されています。
